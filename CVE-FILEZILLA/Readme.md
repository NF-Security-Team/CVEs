# Coordinated Disclosure Timeline
04/01/2022: Report submission to Vendor via email<br>


# Executive Summary
An issue found in "filezilla.exe", the core executable for FileZilla v3.66.5 allows attackers to sideload and execute arbitrary malicious dll upon software execution just by naming it "apphelp.dll".

# Technical Summary
To exploit the vulnerability an attacker must get access to the Software's installation path "C:\Program Data\FileZilla FTP Client\" in order to place the malicous DLL named "apphelp.dll".
Upon every filezilla software execution the dll will be loaded, and then thanks to the "onLoad" method present into the dll code it will execute arbitrary code written by the attacker.
This is possible thanks to a missing dll that the software tries to load at each executable startup, probably a developers leftover.



IMPORTANT: this local vulnerability can be really hard to detect if exploited in the wild.

# Product
Fiilezilla FTP Client

# Tested Version
v3.66.5

# Details
<b> Issue: Persistence mechanism after each software execution </b>

An attacker could easily exploit this vulnerability and set a persistent payload that can execute with a benign host process as parent process.
<br>

DLL target of this vulnerability:

```
apphelp.dll
```

<br>

in the following screenshot you can see the "malicious dll" code that will be invoked by Filezilla normal execution
<br>

![](https://i.imgur.com/FpFVQtM.jpg)

<br>

in the following screenshot you can see the missing dll on Filezilla normal execution
<br>

![](https://i.imgur.com/S6KLFjD.png)

<br>

in the following screenshot you can see the execution tree of Filezilla after succesfully placing the dll file inside its installation path
<br>

![](https://i.imgur.com/KwpNPZN.png)


# Impact
Potentially undetectable persistence after legit "filezilla.exe" binary execution.

# CVE
Not yet assigned

# Credit
This issue was discovered and reported by Nicolas Fasolo (@Err0r0x41414141) team Owner of NF_Security (www.threatfeedservice.it).

# Contact
You can contact the NF_Security team at info@threatfeedservice.it, please include a reference to the CVE in any communication regarding this topic.
