# Coordinated Disclosure Timeline
04/01/2022: Report submission to Vendor via email<br>


# Executive Summary
An issue found in "FilezillaClient.exe", the core executable for FileZilla v3.66.5 allows attackers to sideload and execute arbitrary malicious dll upon software execution.

# Technical Summary
To exploit the vulnerability an attacker must get a Full Dump of the "SangforCSClient.exe" process after the user inserted at least one time his credentials and clicked "Log In" button. 
After a Log In try any string previously inserted in "Username:" and "Password:" textboxes will be written in plaintext inside the Full Dump near known and standard strings or hex array.


![CVE-PoF](https://user-images.githubusercontent.com/34677901/155855975-12966ef1-56bd-4c58-939e-26c0d7643e32.gif)


IMPORTANT: this local vulnerability can expose useful information to an attacker willing to escalate his privileges. After a successful attack lateral movement can be done via multiple ways.

# Product
Sangfor VDI Client

# Tested Version
v5.4.2.1006 

# Details
<b> Issue: Sensitive data written in plaintext into process working memory </b>

After dumping the process Memory you can look for the victim password near the following HEX sequence
<br>

Password location is near "based authentication" string, or seen in HEX:

```
62 61 73 65 64 20 61 75 74 68 65 6E 74 69 63 61 74 69 6F 6E
```
<br>

the username is usually inside the first part of the memory dump, just like you can see in the following screenshot
<br>

![](https://i.imgur.com/SZhjhdV.png)


# Impact
Auth data disclosure.

# CVE
CVE-2022-22908
# Credit
This issue was discovered and reported by Nicolas Fasolo (@Err0r0x41414141) team Owner of NF_Security (www.threatfeedservice.it).

# Contact
You can contact the NF_Security team at info@threatfeedservice.it, please include a reference to CVE-2022-22908 in any communication regarding this topic.
